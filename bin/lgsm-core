#!/usr/bin/env python

import sys, os
from pprint import pprint
from glob import glob
test_roots = set([os.path.dirname(os.path.realpath(__file__)),os.getcwd()])
test_dirs = set([".local/lib/python*/site-packages", "lgsm/modules"])
print test_roots
print test_dirs
for root in test_roots:
	for dir in test_dirs:
		for sp in glob(os.path.join(root,dir)):
			#print(sp)
			sys.path.insert(0, sp)

from lgsmcore import *
#from steam import Steam

#def do_steam(steamcmd_path="/home/jballou/games/steamcmd",steam_path="/home/jballou/games/serverfiles",appid=237410):
#	steam = Steam(steamcmd_path=steamcmd_path,steam_path=steam_path,appid=appid)
#	steam.app_install(appid=appid)

def do_lgsm(steamcmd_path="/home/jballou/games/steamcmd",appid=237410):
	core = LGSMCore()
	print "final config"
	ic = core.interpolate(data=core.config)
#core.interpolate_config()
	pprint(ic)
#	print "config"
#	pprint(core.config)
#	print "gamedata"
#	print core.dump(data=core.gamedata.gamedata,format='tree')
#	print "scriptconfig"
#	print core.dump(data=core.scriptconfig.config, format='tree')
#	print "merge configs"
#	pprint(core.merge_gamedata_to_config())
	print "merged config"
	pprint(core.config)
	print "done"

if __name__ == '__main__':
	do_lgsm()
#	do_steam()
